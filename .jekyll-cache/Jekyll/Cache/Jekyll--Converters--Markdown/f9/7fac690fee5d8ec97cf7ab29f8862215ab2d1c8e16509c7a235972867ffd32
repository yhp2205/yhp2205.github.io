I"m<p>ì•ì„œ í›ˆë ¨í–ˆë˜ ëª¨ë¸ì—ì„œ í›ˆë ¨ ì„¸íŠ¸ë³´ë‹¤ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ê°€ ë” ì ìˆ˜ê°€ ë†’ê²Œ ë‚˜ì™”ìŠµë‹ˆë‹¤.<br />
ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë†ì–´ì˜ ê¸¸ì´ ë¿ë§Œ ì•„ë‹ˆë¼ ë†ì–´ì˜ ë†’ì´ì™€ ë‘ê»˜ ë“±ì˜ ì—¬ëŸ¬ íŠ¹ì„±ë“¤ì„ ì¶”ê°€ë¡œ ì‚¬ìš©í•´ë³´ê² ìŠµë‹ˆë‹¤.<br />
ë˜í•œ ì´ì „ì— ì‚¬ìš©í–ˆë˜ ë°©ë²•ì¸ ê° í•­ì„ ì œê³±í•˜ì—¬ ë°ì´í„°ì— ì¶”ê°€í•˜ëŠ” ê²ƒê³¼ ê° íŠ¹ì„±ì„ ì„œë¡œ ê³±í•´ ìƒˆë¡œìš´ íŠ¹ì„±ì„ ë§Œë“œëŠ” ë°©ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># data load
</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://bit.ly/perch_csv'</span><span class="p">)</span>
<span class="n">perch_full</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">perch_full</span><span class="p">)</span>
</code></pre></div></div>
<blockquote>
  <p>[[ 8.4   2.11  1.41]<br />
 [13.7   3.53  2.  ]<br />
 [15.    3.82  2.43]<br />
 [16.2   4.59  2.63]<br />
 [17.4   4.59  2.94]<br />
 [18.    5.22  3.32]<br />
â€¦</p>
</blockquote>

<p>ì´ë²ˆì—ëŠ” ë°ì´í„°ê°€ ì—¬ëŸ¬ íŠ¹ì„±ì´ ìˆìŒì„ ê³ ë ¤í•˜ì—¬ pandasë¥¼ ì´ìš©í•´ ì§ì ‘ csv ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ì‹ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.<br />
ì´ì œ ì´ì „ê³¼ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ íƒ€ê¹ƒ ë°ì´í„°ë¥¼ ì¤€ë¹„í•˜ê³ , perch_fullê³¼ perch_weightë¥¼ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ë‚˜ëˆ•ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">perch_weight</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.9</span><span class="p">,</span> <span class="mf">32.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">51.5</span><span class="p">,</span> <span class="mf">70.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">78.0</span><span class="p">,</span> <span class="mf">80.0</span><span class="p">,</span> <span class="mf">85.0</span><span class="p">,</span> <span class="mf">85.0</span><span class="p">,</span> <span class="mf">110.0</span><span class="p">,</span>
       <span class="mf">115.0</span><span class="p">,</span> <span class="mf">125.0</span><span class="p">,</span> <span class="mf">130.0</span><span class="p">,</span> <span class="mf">120.0</span><span class="p">,</span> <span class="mf">120.0</span><span class="p">,</span> <span class="mf">130.0</span><span class="p">,</span> <span class="mf">135.0</span><span class="p">,</span> <span class="mf">110.0</span><span class="p">,</span> <span class="mf">130.0</span><span class="p">,</span>
       <span class="mf">150.0</span><span class="p">,</span> <span class="mf">145.0</span><span class="p">,</span> <span class="mf">150.0</span><span class="p">,</span> <span class="mf">170.0</span><span class="p">,</span> <span class="mf">225.0</span><span class="p">,</span> <span class="mf">145.0</span><span class="p">,</span> <span class="mf">188.0</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">,</span> <span class="mf">197.0</span><span class="p">,</span>
       <span class="mf">218.0</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">,</span> <span class="mf">260.0</span><span class="p">,</span> <span class="mf">265.0</span><span class="p">,</span> <span class="mf">250.0</span><span class="p">,</span> <span class="mf">250.0</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">,</span> <span class="mf">320.0</span><span class="p">,</span> <span class="mf">514.0</span><span class="p">,</span>
       <span class="mf">556.0</span><span class="p">,</span> <span class="mf">840.0</span><span class="p">,</span> <span class="mf">685.0</span><span class="p">,</span> <span class="mf">700.0</span><span class="p">,</span> <span class="mf">700.0</span><span class="p">,</span> <span class="mf">690.0</span><span class="p">,</span> <span class="mf">900.0</span><span class="p">,</span> <span class="mf">650.0</span><span class="p">,</span> <span class="mf">820.0</span><span class="p">,</span>
       <span class="mf">850.0</span><span class="p">,</span> <span class="mf">900.0</span><span class="p">,</span> <span class="mf">1015.0</span><span class="p">,</span> <span class="mf">820.0</span><span class="p">,</span> <span class="mf">1100.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1100.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span>
       <span class="mf">1000.0</span><span class="p">])</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">train_input</span><span class="p">,</span> <span class="n">test_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">test_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">perch_full</span><span class="p">,</span> <span class="n">perch_weight</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span>
</code></pre></div></div>

<p>ì‚¬ì´í‚·ëŸ°ì˜ sklearn.preprocessing íŒ¨í‚¤ì§€ì˜ PolynomialFeatures í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•´ì„œ ìƒˆë¡œìš´ íŠ¹ì„±ì„ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤.<br />
PolynomialFeatures í´ë˜ìŠ¤ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ê° íŠ¹ì„±ì„ ì œê³±í•œ í•­ì„ ì¶”ê°€í•˜ê³  íŠ¹ì„±ë¼ë¦¬ ì„œë¡œ ê³±í•œ í•­ì„ ì¶”ê°€í•©ë‹ˆë‹¤.<br />
ì´ë•Œ ê¸°ë³¸ì ìœ¼ë¡œ 1ì„ ì¶”ê°€í•˜ì—¬ ê° íŠ¹ì„±ì— ê³±í•¨ìœ¼ë¡œì¨ ì ˆí¸ì„ ë§Œë“œëŠ”ë°, ì‚¬ì´í‚·ëŸ° ì„ í˜• ëª¨ë¸ì€ ìë™ìœ¼ë¡œ ì ˆí¸ì´ ë“¤ì–´ê°€ìˆê¸° ë•Œë¬¸ì— include_bias=False ì¸ìë¥¼ ì¶”ê°€í•¨ìœ¼ë¡œì„œ ì ˆí¸ì„ ìœ„í•œ í•­ì„ ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>

<span class="c1"># train_inputì„ ë³€í™˜í•˜ì—¬ train_poly ë§Œë“¤ê¸°
</span><span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">include_bias</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">poly</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">)</span>
<span class="n">train_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_input</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">train_poly</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>
<blockquote>
  <p>(42, 9)</p>
</blockquote>

<p>PolynomialFeatures í´ë˜ìŠ¤ëŠ” 9ê°œì˜ íŠ¹ì„±ì´ ì–´ë–»ê²Œ ë°˜ì˜ë˜ì–´ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤.<br />
get_feature_names() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poly</span><span class="p">.</span><span class="n">get_feature_names</span><span class="p">()</span>
</code></pre></div></div>
<blockquote>
  <p>[â€˜x0â€™, â€˜x1â€™, â€˜x2â€™, â€˜x0^2â€™, â€˜x0 x1â€™, â€˜x0 x2â€™, â€˜x1^2â€™, â€˜x1 x2â€™, â€˜x2^2â€™]</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#test set ë³€í™˜í•˜ê¸°
</span><span class="n">test_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>

<span class="c1">#ë‹¤ì¤‘íšŒê·€ ëª¨ë¸ í›ˆë ¨í•˜ê¸°
</span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_poly</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_poly</span><span class="p">,</span> <span class="n">train_target</span><span class="p">))</span>
</code></pre></div></div>
<blockquote>
  <p>0.9903183436982124</p>
</blockquote>

<p>train setì„ ì´ìš©í•˜ì—¬ ì ìˆ˜ë¥¼ ë‚´ë³´ì•˜ìœ¼ë‹ˆ test setë„ ì ìˆ˜ë¥¼ ì¶œë ¥í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#test set ì ìˆ˜ë„ í™•ì¸í•˜ê¸°
</span><span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_poly</span><span class="p">,</span> <span class="n">test_target</span><span class="p">))</span>
</code></pre></div></div>
<blockquote>
  <p>0.9714559911594134</p>
</blockquote>

<p>í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ì ìˆ˜ì™€ í›ˆë ¨ì„¸íŠ¸ ì ìˆ˜ ëª¨ë‘ ë†’ê²Œ ë‚˜ì˜¤ë©´ì„œ train ì„¸íŠ¸ê°€ ë” ì ìˆ˜ê°€ ë†’ê²Œ ë‚˜ì˜¨ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
ì´ì œ íŠ¹ì„±ì„ ë” ë§ì´ ì¶”ê°€í•´ë³´ê² ìŠµë‹ˆë‹¤.<br />
PolynomialFeatures í´ë˜ìŠ¤ì˜ degree ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ê³ ì°¨í•­ì˜ ìµœëŒ€ ì°¨ìˆ˜ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">include_bias</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="n">poly</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">)</span>
<span class="n">train_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_input</span><span class="p">)</span>
<span class="n">test_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">train_poly</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>
<blockquote>
  <p>(42, 55)</p>
</blockquote>

<p>ë§Œë“¤ì–´ì§„ íŠ¹ì„±ì˜ ê°œìˆ˜ê°€ 55ê°œì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
train_poly ë°°ì—´ì˜ ì—´ì˜ ê°œìˆ˜ê°€ íŠ¹ì„±ì˜ ê°œìˆ˜ë¼ê³  ìƒê°í•˜ë©´ ë©ë‹ˆë‹¤.<br />
ì´ì œ transformì„ ë§ˆì³¤ìœ¼ë‹ˆ ì´ ë°ì´í„°ë¡œ ë‹¤ì‹œ í›ˆë ¨í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lr</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_poly</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_poly</span><span class="p">,</span> <span class="n">train_target</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_poly</span><span class="p">,</span> <span class="n">test_target</span><span class="p">))</span>
</code></pre></div></div>
<blockquote>
  <p>0.9999999999991097<br />
-144.40579242684848</p>
</blockquote>

<p>ê²°ê³¼ë¥¼ ë³´ë©´ train setì— ëŒ€í•œ ì ìˆ˜ëŠ” ë§¤ìš° ë†’ê²Œ ë‚˜ì˜¤ê³ , test setì— ëŒ€í•œ ì ìˆ˜ëŠ” ìŒìˆ˜ê°€ ë‚˜ì™”ìŠµë‹ˆë‹¤.<br />
ì´ëŠ” íŠ¹ì„±ì˜ ê°œìˆ˜ë¥¼ í¬ê²Œ ëŠ˜ë ¸ê¸° ë•Œë¬¸ì— train setì— ëŒ€í•´ ê³¼ëŒ€ì í•©ëœ ê²°ê³¼ë¡œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
ì´ëŸ¬í•œ ê³¼ëŒ€ì í•©ì„ ì¤„ì´ê¸° ìœ„í•´ì„œëŠ” ì„ í˜• íšŒê·€ ëª¨ë¸ì˜ ê³„ìˆ˜ë¥¼ ê·œì œí•˜ì—¬ í•´ê²°í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">ss</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">ss</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_poly</span><span class="p">)</span>
<span class="n">train_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_poly</span><span class="p">)</span>
<span class="n">test_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_poly</span><span class="p">)</span>
</code></pre></div></div>

<p>ì„ í˜• íšŒê·€ ëª¨ë¸ì— ê·œì œë¥¼ ì¶”ê°€í•œ ëª¨ë¸ì„ ridgeì™€ lassoë¼ê³  ë¶€ë¥´ëŠ”ë°, ë¦¿ì§€ëŠ” ê³„ìˆ˜ë¥¼ ì œê³±í•œ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ê·œì œë¥¼ ì ìš©í•˜ê³ , ë¼ì˜ëŠ” ê³„ìˆ˜ì˜ ì ˆëŒ“ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ê·œì œë¥¼ ì ìš©í•©ë‹ˆë‹¤.<br />
ì¼ë°˜ì ìœ¼ë¡œëŠ” ë¦¿ì§€ë¥¼ ì¡°ê¸ˆ ë” ì„ í˜¸í•˜ê¸° ë•Œë¬¸ì— ë¦¿ì§€ íšŒê·€ë¥¼ ë¨¼ì € í›ˆë ¨í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span>
<span class="n">ridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">()</span>
<span class="n">ridge</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">ridge</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="n">ridge</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">,</span> <span class="n">test_target</span><span class="p">))</span>
</code></pre></div></div>
<blockquote>
  <p>0.9896101671037343<br />
0.9790693977615397</p>
</blockquote>

<p>ridge ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ í›ˆë ¨í•œ ê²°ê³¼ ë§ì€ íŠ¹ì„±ì„ ì‚¬ìš©í–ˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³  í›ˆë ¨ì„¸íŠ¸, í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ëª¨ë‘ì—ì„œ ì¢‹ì€ ì ìˆ˜ê°€ ë‚˜ì™”ìŠµë‹ˆë‹¤.<br />
ë¦¿ì§€ì™€ ë¼ì˜ ëª¨ë¸ì„ ì ìš©í•  ë•Œ ëª¨ë¸ ê°ì²´ ì¤‘ alpha ê°’ì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ê·œì œì˜ ì •ë„ë¥¼ ì •í•  ìˆ˜ ìˆëŠ”ë°,
alphaê°’ì´ í¬ë©´ ê·œì œì˜ ê°•ë„ê°€ ì„¸ê¸° ë•Œë¬¸ì— ê³¼ì†Œì í•©ë  ê°€ëŠ¥ì„±ì´ í¬ê³ ,
ì‘ìœ¼ë©´ ê³„ìˆ˜ë¥¼ ì¤„ì´ëŠ” ì—­í• ì´ ì¤„ì–´ë“¤ê³  ì„ í˜• íšŒê·€ ëª¨ë¸ê³¼ ìœ ì‚¬í•´ì§€ê¸° ë•Œë¬¸ì— ê³¼ëŒ€ì í•©ë  ê°€ëŠ¥ì„±ì´ í½ë‹ˆë‹¤.<br />
ì ì ˆí•œ alpha ê°’ì„ ì°¾ê¸° ìœ„í•´ì„œëŠ” alpha ê°’ì— ëŒ€í•œ ê²°ì •ê³„ìˆ˜ ê°’ì„ ê·¸ë ¤ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì ìˆ˜ê°€ ê°€ì¥ ê°€ê¹Œìš´ ì§€ì ì„ ìµœì ì˜ alpha ê°’ìœ¼ë¡œ ìƒê°í•˜ë©´ ë©ë‹ˆë‹¤.<br />
ê·¸ëŸ¼ alphaê°’ì„ ë°”ê¿€ ë•Œ ë§ˆë‹¤ score ê°’ì„ ì €ì¥í•  ë¦¬ìŠ¤íŠ¸ë¥¼ ë¨¼ì € ë§Œë“¤ì–´ì£¼ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">train_score</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_score</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1">#alpha ê°’ ë¦¬ìŠ¤íŠ¸ ìƒì„±
</span><span class="n">alpha_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alpha_list</span> <span class="p">:</span>
  <span class="c1">#ridge model ìƒì„±
</span>  <span class="n">ridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
  <span class="c1">#ridge model í›ˆë ¨
</span>  <span class="n">ridge</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
  <span class="c1">#í›ˆë ¨ ì ìˆ˜ì™€ í…ŒìŠ¤íŠ¸ ì ìˆ˜ ì €ì¥
</span>  <span class="n">train_score</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">ridge</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">))</span>
  <span class="n">test_score</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">ridge</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">,</span> <span class="n">test_target</span><span class="p">))</span>
</code></pre></div></div>
<p>ì´ì œ alpha ê°’ì— ë”°ë¥¸ ê·¸ë˜í”„ë¥¼ ê·¸ë ¤ ê°’ì„ í™•ì¸í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.<br />
ê·¸ëƒ¥ ê·¸ë¦¬ë©´ ê·¸ë˜í”„ ì™¼ìª½ì´ ë„ˆë¬´ ì´˜ì´˜í•´ì§€ê¸° ë•Œë¬¸ì— ë¡œê·¸í•¨ìˆ˜ë¡œ ë°”ê¿” í‘œí˜„í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">log10</span><span class="p">(</span><span class="n">alpha_list</span><span class="p">),</span> <span class="n">train_score</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">log10</span><span class="p">(</span><span class="n">alpha_list</span><span class="p">),</span> <span class="n">test_score</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'alpha'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'R^2'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="../assets/images/HG03-1/HG3-3-1.png" alt="HG3-3-1" /><br />
<br />
ë‹¤ìŒ ê·¸ë˜í”„ë¥¼ í™•ì¸í•´ë³´ë©´, ì ì ˆí•œ alpha ê°’ì´ -1, ì¦‰ 0.1 ì´ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
alpha ê°’ì„ 0.1ë¡œ ì§€ì •í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨í•˜ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">ridge</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">ridge</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">ridge</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">,</span> <span class="n">test_target</span><span class="p">))</span>
</code></pre></div></div>
<blockquote>
  <p>0.9903815817570366<br />
0.9827976465386926</p>
</blockquote>

<p>trainê°’ì´ testê°’ë³´ë‹¤ ë†’ê²Œ ë‚˜ì˜¤ë©´ì„œ ë‘ ì ìˆ˜ ëª¨ë‘ ì ì ˆí•œ ì ìˆ˜ê°€ ë‚˜ì˜¨ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
ì´ì œ lasso íšŒê·€ëª¨ë¸ì„ í›ˆë ¨í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_score</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_score</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">alpha_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alpha_list</span><span class="p">:</span>
  <span class="c1"># lasso modelì„ ë§Œë“¤ê¸°
</span>  <span class="n">lasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">max_iter</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">)</span>
  <span class="c1"># lasso model í›ˆë ¨í•˜ê¸°
</span>  <span class="n">lasso</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
  <span class="c1"># train setì™€ test set scoreì„ ì €ì¥
</span>  <span class="n">train_score</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">lasso</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">))</span>
  <span class="n">test_score</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">lasso</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">,</span> <span class="n">test_target</span><span class="p">))</span>

<span class="c1">#xì¶•ì„ ë¡œê·¸ìŠ¤ì¼€ì¼ë¡œ ë°”ê¿” ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
</span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">log10</span><span class="p">(</span><span class="n">alpha_list</span><span class="p">),</span> <span class="n">train_score</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">log10</span><span class="p">(</span><span class="n">alpha_list</span><span class="p">),</span> <span class="n">test_score</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'alpha'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'R^2'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="../assets/images/HG03-1/HG3-3-2.png" alt="HG3-3-2" /><br />
<br />
ìœ„ ê·¸ë˜í”„ë¥¼ í™•ì¸í–ˆì„ ë•Œ ì˜¬ë°”ë¥¸ alphaê°’ì€ 1ì´ë¼ëŠ”ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
ì´ ê°’ìœ¼ë¡œ lasso ëª¨ë¸ì„ í›ˆë ¨í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lasso</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">lasso</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">lasso</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">,</span> <span class="n">test_target</span><span class="p">))</span>
</code></pre></div></div>
<blockquote>
  <p>0.9888067471131867<br />
0.9824470598706695</p>
</blockquote>

<p>lasso ëª¨ë¸ì€ ê³„ìˆ˜ê°’ì„ 0ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
ë¼ì˜ëª¨ë¸ì˜ ê³„ìˆ˜ì¤‘ 0ì¸ê²ƒì˜ ê°œìˆ˜ë¥¼ ì¶œë ¥í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">lasso</span><span class="p">.</span><span class="n">coef_</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>
</code></pre></div></div>
<blockquote>
  <p>40</p>
</blockquote>

<p>ê³„ìˆ˜ê°€ 0ì¸ í•­ì´ 40ê°œì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
ì´ 55ê°œì˜ íŠ¹ì„± ì¤‘ 15ê°œë§Œ ì‚¬ìš©í•œ ê²ƒì…ë‹ˆë‹¤.<br />
ì´ëŸ° íŠ¹ì„±ì´ ìˆê¸° ë•Œë¬¸ì— ë¼ì˜ ëª¨ë¸ì„ ìœ ìš©í•œ íŠ¹ì„±ì„ ê³¨ë¼ë‚´ëŠ” ë°ì— ì‚¬ìš©í•˜ê¸°ë„ í•©ë‹ˆë‹¤.<br />
ë¦¿ì§€ì™€ ë¼ì˜ íšŒê·€ë¥¼ ì‚¬ìš©í•˜ì—¬ ìµœì ì˜ alpha ê°’ì„ ì°¾ì•„ë³´ê³  íŠ¹ì„±ì´ ë§ì€ ë°ì´í„°ë¥¼ ê·œì œí•˜ì—¬ ëª¨ë¸ì˜ ì„±ëŠ¥ì„ í™•ì¸í•´ë´¤ìŠµë‹ˆë‹¤.</p>
:ET