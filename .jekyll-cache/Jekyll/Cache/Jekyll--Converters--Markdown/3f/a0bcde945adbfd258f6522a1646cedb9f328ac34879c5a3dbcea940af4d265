I"Üm<h2 id="ë¡œì§€ìŠ¤í‹±-íšŒê·€">ë¡œì§€ìŠ¤í‹± íšŒê·€</h2>

<p>ëœë¤í•˜ê²Œ ë‹´ê¸´ ìƒì„ ì˜ í™•ë¥ ì„ ì•Œì•„ë³´ë ¤ê³  í•©ë‹ˆë‹¤.<br />
ìš°ì„  ì•ì„œ ë°°ì› ë˜ k-ìµœê·¼ì ‘ ì´ì›ƒ ë¶„ë¥˜ê¸°ë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í•œ ì´ì›ƒ í´ë˜ìŠ¤ë¥¼ í† ëŒ€ë¡œ íƒ€ê¹ƒ ìƒì„ ì˜ í™•ë¥ ì„ ê³„ì‚°í•´ë³´ê² ìŠµë‹ˆë‹¤.<br />
ë¨¼ì € ë°ì´í„°ë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">fish</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://bit.ly/fish_csv'</span><span class="p">)</span>
<span class="n">fish</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="https://github.com/yhp2205/yhp2205.github.io/blob/main/assets/images/HG4/HG4-1-1.png?raw=true" alt="HG4-1-1" /><br />
<br />
ê·¸ë¦¬ê³  target ë°ì´í„°ê°€ ë  Species ì—´ì— ì–´ë–¤ ì¢…ë¥˜ê°€ ìˆëŠ”ì§€ íŒë‹¤ìŠ¤ì˜ unique í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ í™•ì¸í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">pd</span><span class="p">.</span><span class="n">unique</span><span class="p">(</span><span class="n">fish</span><span class="p">[</span><span class="s">'Species'</span><span class="p">]))</span>
</code></pre></div></div>
<blockquote>
  <p>[â€˜Breamâ€™ â€˜Roachâ€™ â€˜Whitefishâ€™ â€˜Parkkiâ€™ â€˜Perchâ€™ â€˜Pikeâ€™ â€˜Smeltâ€™]</p>
</blockquote>

<p>Species ì— ë“¤ì–´ìˆëŠ” ì¢…ë“¤ì„ í™•ì¸í–ˆìœ¼ë‹ˆ fish ë°ì´í„°ì—ì„œ Species ì—´ì„ ì œì™¸í•˜ê³  ë‚˜ë¨¸ì§€ 5ê°œì˜ ì—´ì„ ì…ë ¥ ë°ì´í„°ë¡œ ì„ íƒí•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fish_input</span> <span class="o">=</span> <span class="n">fish</span><span class="p">[[</span><span class="s">'Weight'</span><span class="p">,</span> <span class="s">'Length'</span><span class="p">,</span> <span class="s">'Diagonal'</span><span class="p">,</span> <span class="s">'Height'</span><span class="p">,</span> <span class="s">'Width'</span><span class="p">]].</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">fish_input</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</code></pre></div></div>
<blockquote>
  <p>[[242.      25.4     30.      11.52     4.02  ]<br />
 [290.      26.3     31.2     12.48     4.3056]<br />
 [340.      26.5     31.1     12.3778   4.6961]<br />
 [363.      29.      33.5     12.73     4.4555]<br />
 [430.      29.      34.      12.444    5.134 ]]</p>
</blockquote>

<p>ì…ë ¥ ë°ì´í„°ê°€ ì˜ ìƒì„±ëœ ê²ƒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.<br />
 ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ target ë°ì´í„°ë„ ë§Œë“­ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fish_target</span> <span class="o">=</span> <span class="n">fish</span><span class="p">[</span><span class="s">'Species'</span><span class="p">].</span><span class="n">to_numpy</span><span class="p">()</span>
</code></pre></div></div>
<p>ì´ì œ train setì™€ test setë¡œ ë‚˜ëˆ•ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">train_input</span><span class="p">,</span> <span class="n">test_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">test_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">fish_input</span><span class="p">,</span> <span class="n">fish_target</span><span class="p">)</span>
</code></pre></div></div>
<p>train ì„¸íŠ¸ì™€ testë¥¼ ì¤€ë¹„í–ˆìœ¼ë‹ˆ ë°ì´í„°ë¥¼ í‘œì¤€í™” ì „ì²˜ë¦¬ë¥¼ í•´ì¤ë‹ˆë‹¤.<br />
ì‚¬ì´í‚·ëŸ°ì˜ StandardScalerì„ ì´ìš©í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#í›ˆë ¨ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ í‘œì¤€í™” ì „ì²˜ë¦¬
</span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">ss</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">ss</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">)</span>
<span class="n">train_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_input</span><span class="p">)</span>
<span class="n">test_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
</code></pre></div></div>
<p>ì‚¬ì´í‚·ëŸ°ì˜ KNeighborsClassifier í´ë˜ìŠ¤ ê°ì²´ë¥¼ ë§Œë“¤ê³  í›ˆë ¨ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ì„¸íŠ¸ì˜ ê° ì ìˆ˜ë¥¼ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.<br />
ìµœê·¼ì ‘ ì´ì›ƒì˜ ê°œìˆ˜ì¸ këŠ” 3ìœ¼ë¡œ ì§€ì •í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#ìµœê·¼ì ‘ ì´ì›ƒ ë¶„ë¥˜ê¸°ì˜ í™•ë¥  ì˜ˆì¸¡
</span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="n">kn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">kn</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">kn</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">kn</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">,</span> <span class="n">test_target</span><span class="p">))</span>
</code></pre></div></div>
<blockquote>
  <p>0.8739495798319328<br />
0.75</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">kn</span><span class="p">.</span><span class="n">classes_</span><span class="p">)</span>
</code></pre></div></div>
<blockquote>
  <p>[â€˜Breamâ€™ â€˜Parkkiâ€™ â€˜Perchâ€™ â€˜Pikeâ€™ â€˜Roachâ€™ â€˜Smeltâ€™ â€˜Whitefishâ€™]</p>
</blockquote>

<p>ì•ŒíŒŒë²³ ìˆœì„œë¡œ ë§¤ê²¨ì§„ ê²ƒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.<br />
ì´ì œ predict ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ test setì— ìˆëŠ” ì²˜ìŒ 5ê°œì˜ ìƒ˜í”Œì˜ íƒ€ê¹ƒê°’ì„ ì˜ˆì¸¡í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">kn</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">[:</span><span class="mi">5</span><span class="p">]))</span>
</code></pre></div></div>
<blockquote>
  <p>[â€˜Parkkiâ€™ â€˜Perchâ€™ â€˜Roachâ€™ â€˜Perchâ€™ â€˜Perchâ€™]</p>
</blockquote>

<p>predict ì˜ˆì¸¡ ê°’ì´ ì–´ë–»ê²Œ ë‚˜ì™”ëŠ”ì§€ predict_proba() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë©´ í´ë˜ìŠ¤ë³„ í™•ë¥  ê°’ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">proba</span> <span class="o">=</span> <span class="n">kn</span><span class="p">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="n">proba</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>  <span class="c1">#ì†Œìˆ«ì  ë„·ì§¸ìë¦¬ê¹Œì§€ í‘œê¸°(ë‹¤ì„¯ë²ˆì§¸ì—ì„œ ë°˜ì˜¬ë¦¼)
</span></code></pre></div></div>
<blockquote>
  <p>[[0.     0.6667 0.3333 0.     0.     0.     0.    ]<br />
 [0.     0.     1.     0.     0.     0.     0.    ]<br />
 [0.     0.     0.3333 0.     0.6667 0.     0.    ]<br />
 [0.     0.     1.     0.     0.     0.     0.    ]<br />
 [0.     0.     0.3333 0.     0.3333 0.3333 0.    ]]</p>
</blockquote>

<p>ì²«ë²ˆì§¸ ì—´ì´ Bream, ë‘ë²ˆì§¸ ì—´ì´ Parkki, ì„¸ë²ˆì§¸ ì—´ì´ Perch, â€¦ ì— ëŒ€í•œ í™•ë¥ ì„ ë‚˜íƒ€ë‚´ê³  ìˆìŠµë‹ˆë‹¤.<br />
 ê³„ì‚°í•œ ë¹„ìœ¨ì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ì²« ë²ˆì§¸ ìƒ˜í”Œì˜ ìµœê·¼ì ‘ ì´ì›ƒë“¤ì„ ì¶œë ¥í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">distances</span><span class="p">,</span> <span class="n">indexes</span> <span class="o">=</span> <span class="n">kn</span><span class="p">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">train_target</span><span class="p">[</span><span class="n">indexes</span><span class="p">])</span>
</code></pre></div></div>
<blockquote>
  <p>[[â€˜Parkkiâ€™ â€˜Parkkiâ€™ â€˜Perchâ€™]]</p>
</blockquote>

<p>ì²« ë²ˆì§¸ ìƒ˜í”Œì˜ ì´ì›ƒì€ Perchê°€ 1ê°œ, Parkkiê°€ 2ê°œì„ì„ í™•ì¸í•©ë‹ˆë‹¤.<br />
ì—¬ê¸°ê¹Œì§€ k-ìµœê·¼ì ‘ ì´ì›ƒ ë¶„ë¥˜ê¸°ë¥¼ ì‚¬ìš©í•œ í™•ë¥  ì˜ˆì¸¡ì„ í•´ë³´ì•˜ìŠµë‹ˆë‹¤.<br />
<br />
ì´ì œ ë³¸ê²©ì ìœ¼ë¡œ ë¡œì§€ìŠ¤í‹± íšŒê·€ë¥¼ ì´ìš©í•œ ì˜ˆì¸¡ì„ í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<p>ë¡œì§€ìŠ¤í‹± íšŒê·€ëŠ” ì„ í˜•íšŒê·€ì™€ ë™ì¼í•˜ê²Œ ì„ í˜• ë°©ì •ì‹ì„ í•™ìŠµí•©ë‹ˆë‹¤.<br />
<img src="https://github.com/yhp2205/yhp2205.github.io/blob/main/assets/images/HG4/HG4-1-2.png?raw=true" alt="HG4-1-2" /><br />
<br />
ì—¬ê¸°ì„œ ê° ë³€ìˆ˜ ì•ì— ê³±í•´ì§„ ê°’ë“¤ì€ ê°€ì¤‘ì¹˜ë‚˜ ê³„ìˆ˜ì˜ ì—­í• ì„ í•©ë‹ˆë‹¤.<br />
zëŠ” ì–´ë–¤ ê°’ë„ ê°€ëŠ¥í•˜ì§€ë§Œ, í™•ë¥ ì´ ë˜ê¸° ìœ„í•´ì„œëŠ” 0ê³¼ 1 ì‚¬ì´ì˜ ê°’ì„ ê°€ì ¸ì•¼ í•©ë‹ˆë‹¤.<br />
zê°€ í° ìŒìˆ˜ì¼ë•Œ 0ì´ ë˜ê³  í° ì–‘ìˆ˜ì¼ ë•Œ 1ì´ ë˜ë„ë¡ í•˜ë ¤ë©´ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.</p>

<p><img src="https://mblogthumb-phinf.pstatic.net/MjAxNzA5MjZfMzMg/MDAxNTA2NDIzMjMzNjE5.arSKSXckfkmGqMIEA0dAI1q_e080ntMcpyhXhBx2m4Ig.nofSEy_ifZ6BM7VvFOku71bQbM8d2ngYWwV_sO8oyNEg.PNG.junhyuk7272/%EC%9E%90%EC%97%B0%EC%A7%80%EC%88%98%ED%95%A8%EC%88%98.png?type=w2" alt="HG4-1-32" />
<br />
<img src="https://github.com/yhp2205/yhp2205.github.io/blob/main/assets/images/HG4/HG4-1-3.png?raw=true" alt="HG4-1-3" /><br />
<br /></p>

<p>ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í˜•íƒœë¥¼ ë•ë‹ˆë‹¤.<br />
ë„˜íŒŒì´ë¥¼ ì‚¬ìš©í•´ì„œ ê·¸ë˜í”„ë¥¼ ê·¸ë ¤ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'z'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'phi'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="https://github.com/yhp2205/yhp2205.github.io/blob/main/assets/images/HG4/HG4-1-4.png?raw=true" alt="HG4-1-4" /><br />
<br /></p>

<p>ì´ì œ ë¡œì§€ìŠ¤í‹± íšŒê·€ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ì§„ë¶„ë¥˜ë¥¼ í•´ë³´ê² ìŠµë‹ˆë‹¤.<br />
train ë°ì´í„°ì—ì„œ ë¶ˆë¦¬ì–¸ ì¸ë±ì‹±ì„ ì‚¬ìš©í•˜ì—¬ ë„ë¯¸ì™€ ë¹™ì–´ë§Œ ë”°ë¡œ ì¶œë ¥í•´ì¤ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#ë„ë¯¸(Bream)ì™€ ë¹™ì–´(Smelt)ë§Œ ì¶œë ¥í•˜ê¸°
</span><span class="n">bream_smelt_indexes</span> <span class="o">=</span> <span class="p">(</span><span class="n">train_target</span> <span class="o">==</span> <span class="s">'Bream'</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="n">train_target</span> <span class="o">==</span> <span class="s">'Smelt'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">bream_smelt_indexes</span><span class="p">)</span>
</code></pre></div></div>
<blockquote>
  <p>[False  True False False False False  True False False  True False  True
  True False False False  True  True False  True False False  True False
 False False  True False False False False False False False  True False
  True  True False  True False False  True False False  True False  True
 False False  True  True False False False  True  True False False False
  True  True False False False False False False False  True False  True
 False False  True False False False False  True False False False False
  True False  True False False False False False False False  True  True
 False False False False  True  True False False False False False False
 False False False False  True  True  True False False  True False]</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_bream_smelt</span> <span class="o">=</span> <span class="n">train_scaled</span><span class="p">[</span><span class="n">bream_smelt_indexes</span><span class="p">]</span>
<span class="n">target_bream_smelt</span> <span class="o">=</span> <span class="n">train_target</span><span class="p">[</span><span class="n">bream_smelt_indexes</span><span class="p">]</span>
</code></pre></div></div>
<p>ì´ ë°ì´í„°ë¥¼ ì´ìš©í•˜ì—¬ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì„ í›ˆë ¨í•˜ê³  ê·¸ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ train_bream_smeltì— ìˆëŠ” ì²˜ìŒ 5ê°œì˜ ìƒ˜í”Œì„ ì¶œë ¥í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_bream_smelt</span><span class="p">,</span> <span class="n">target_bream_smelt</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">train_bream_smelt</span><span class="p">[:</span><span class="mi">5</span><span class="p">]))</span>
</code></pre></div></div>
<blockquote>
  <p>[â€˜Smeltâ€™ â€˜Smeltâ€™ â€˜Smeltâ€™ â€˜Smeltâ€™ â€˜Breamâ€™]</p>
</blockquote>

<p>ë‹¤ì„¯ ë²ˆì§¸ë¥¼ ë„ë¯¸, ë‚˜ë¨¸ì§€ë¥¼ ë¹™ì–´ë¡œ ì˜ˆì¸¡í–ˆìŠµë‹ˆë‹¤.<br />
5ê°œ ìƒ˜í”Œì˜ í™•ë¥ ì„ í™•ì¸í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">train_bream_smelt</span><span class="p">[:</span><span class="mi">5</span><span class="p">]))</span>
</code></pre></div></div>
<blockquote>
  <p>[[0.03391154 0.96608846]<br />
 [0.03603855 0.96396145]<br />
 [0.03582089 0.96417911]<br />
 [0.02900509 0.97099491]<br />
 [0.99410165 0.00589835]]</p>
</blockquote>

<p>ë‘ ê°œì˜ ì—´ ì¤‘ì— ì–´ë–¤ ê²ƒì´ ë„ë¯¸ì´ê³  ë¹™ì–´ì¸ì§€ í—·ê°ˆë¦°ë‹¤ë©´ classes_ ë¥¼ ì‚¬ìš©í•˜ì—¬ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">classes_</span><span class="p">)</span>
</code></pre></div></div>
<blockquote>
  <p>[â€˜Breamâ€™ â€˜Smeltâ€™]</p>
</blockquote>

<p>ì´ì œ ë¡œì§€ìŠ¤í‹± íšŒê·€ê°€ í•™ìŠµí•œ ê³„ìˆ˜ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">coef_</span><span class="p">,</span> <span class="n">lr</span><span class="p">.</span><span class="n">intercept_</span><span class="p">)</span>
</code></pre></div></div>
<blockquote>
  <p>[[-0.42646881 -0.60256452 -0.68252074 -0.99456193 -0.78263044]] [-2.28791769]</p>
</blockquote>

<p>ì´ë¥¼ í†µí•´ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì´ í•™ìŠµí•œ ë°©ì •ì‹ì„ ë‹¤ìŒê³¼ ê°™ì´ ë„ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
<img src="https://github.com/yhp2205/yhp2205.github.io/blob/main/assets/images/HG4/HG4-1-5.png?raw=true" alt="HG4-1-5" /><br />
<br />
ì´ì œ ì´ ë°©ì •ì‹ì„ ì´ìš©í•˜ì—¬ z ê°’ì„ ê³„ì‚°í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">decisions</span> <span class="o">=</span> <span class="n">lr</span><span class="p">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">train_bream_smelt</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">decisions</span><span class="p">)</span>
</code></pre></div></div>
<blockquote>
  <p>[ 3.34950001  3.28646197  3.29274597  3.51084984 -5.12716733]</p>
</blockquote>

<p>ì´ zê°’ì„ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ì— í†µê³¼í•˜ë©´ í™•ë¥ ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
scipyì— ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë¥¼ ì œê³µí•˜ëŠ” expit()ë¥¼ ì‚¬ìš©í•´ì„œ í™•ë¥ ì„ êµ¬í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">expit</span>
<span class="k">print</span><span class="p">(</span><span class="n">expit</span><span class="p">(</span><span class="n">decisions</span><span class="p">))</span>
</code></pre></div></div>
<blockquote>
  <p>[0.96608846 0.96396145 0.96417911 0.97099491 0.00589835]</p>
</blockquote>

<p>ì´ì œ ë‹¤ì¤‘ ë¶„ë¥˜ë¥¼ ìˆ˜í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">max_iter</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">lr</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">,</span> <span class="n">test_target</span><span class="p">))</span>
</code></pre></div></div>
<blockquote>
  <p>0.9411764705882353<br />
0.85</p>
</blockquote>

<p>test ì„¸íŠ¸ì˜ ì²˜ìŒ 5ê°œ ìƒ˜í”Œì— ëŒ€í•œ ì˜ˆì¸¡ì„ ì¶œë ¥í•´ë´…ë‹ˆë‹¤.<br />
ê·¸ë¦¬ê³  ê·¸ ì˜ˆì¸¡ì— ëŒ€í•œ í™•ë¥ ì„ ì¶œë ¥í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#test setì˜ ì²˜ìŒ 5ê°œ ìƒ˜í”Œì— ëŒ€í•œ ì˜ˆì¸¡
</span><span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">[:</span><span class="mi">5</span><span class="p">]))</span>
</code></pre></div></div>
<blockquote>
  <p>[â€˜Parkkiâ€™ â€˜Perchâ€™ â€˜Roachâ€™ â€˜Perchâ€™ â€˜Perchâ€™]</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#test setì˜ ì²˜ìŒ 5ê°œì— ëŒ€í•œ ì˜ˆì¸¡ í™•ë¥ 
</span><span class="n">proba</span> <span class="o">=</span> <span class="n">lr</span><span class="p">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="n">proba</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span> <span class="c1">#ì†Œìˆ˜ì  ì„¸ë²ˆì§¸ìë¦¬ê¹Œì§€ í‘œê¸°
</span></code></pre></div></div>
<blockquote>
  <p>[[0.01  0.73  0.006 0.    0.223 0.    0.03 ]<br />
 [0.01  0.    0.898 0.002 0.    0.    0.089]<br />
 [0.001 0.018 0.28  0.002 0.661 0.    0.038]<br />
 [0.002 0.    0.953 0.001 0.    0.    0.044]<br />
 [0.    0.012 0.816 0.    0.119 0.051 0.002]]</p>
</blockquote>

<p>5ê°œ ìƒ˜í”Œê³¼ 7ê°œì˜ í´ë˜ìŠ¤ê°€ ìˆê¸° ë•Œë¬¸ì— 5ê°œì˜ í–‰ê³¼ 7ê°œì˜ ì—´ë¡œ ì¶œë ¥ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.<br />
ê° ì—´ì´ ì˜ë¯¸í•˜ëŠ” ê²ƒì´ ì–´ë–¤ ìƒì„ ì— ëŒ€í•œ í™•ë¥ ì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#classes_ì†ì„±ìœ¼ë¡œ í´ë˜ìŠ¤ ì •ë³´ í™•ì¸
</span><span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">classes_</span><span class="p">)</span>
</code></pre></div></div>
<blockquote>
  <p>[â€˜Breamâ€™ â€˜Parkkiâ€™ â€˜Perchâ€™ â€˜Pikeâ€™ â€˜Roachâ€™ â€˜Smeltâ€™ â€˜Whitefishâ€™]</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">coef_</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">lr</span><span class="p">.</span><span class="n">intercept_</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>
<blockquote>
  <p>(7, 5) (7,)</p>
</blockquote>

<p>coef_ ë°°ì—´ì´ 7í–‰ì— 5ì—´ì˜ í˜•íƒœë¥¼ ë„ê³  ìˆê³  intercept_ë„ 7ê°œê°€ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
7ê°œì˜ í´ë˜ìŠ¤ê°€ ìˆê¸° ë•Œë¬¸ì— í´ë˜ìŠ¤ë§ˆë‹¤ zê°’ì„ ê³„ì‚°í•˜ì—¬ ì´ 7ê°œì˜ zê°’ì´ ë‚˜ì˜¨ë‹¤ëŠ” ë§ê³¼ ê°™ìŠµë‹ˆë‹¤.</p>

<p>ì´ì™€ ê°™ì´ 7ê°œì˜ zê°’ë“¤ì„ í™•ë¥ ë¡œ ë°”ê¾¸ê¸° ìœ„í•´ ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.<br />
<img src="https://github.com/yhp2205/yhp2205.github.io/blob/main/assets/images/HG4/HG4-1-6.png?raw=true" alt="HG4-1-6" /><br />
<br />
7ê°œì˜ zê°’ì„ ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ í™•ë¥ ë¡œ ë°”ê¾¸ë©´ 0ê³¼ 1ì‚¬ì´ì˜ ê°’ì„ ê°€ì§„ í™•ë¥ ì´ ì¶œë ¥ë©ë‹ˆë‹¤.<br />
ê·¸ëŸ¼ 7ê°œì˜ zê°’ì„ êµ¬í•œ í›„ì— ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ í™•ë¥ ë¡œ ë°”ê¾¸ì–´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#z1ë¶€í„° z7ê¹Œì§€ì˜ ê°’ êµ¬í•˜ê³  í™•ë¥ ë¡œ ë°”ê¾¸ê¸°
</span><span class="n">decision</span> <span class="o">=</span> <span class="n">lr</span><span class="p">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="n">decision</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span> <span class="c1">#ì†Œìˆ˜ì  ë‘˜ì§¸ìë¦¬ê¹Œì§€ í‘œê¸°
</span></code></pre></div></div>
<blockquote>
  <p>[[ -0.17   4.13  -0.67  -3.44   2.95  -3.75   0.96]<br />
 [  4.31  -5.68   8.79   2.78   0.69 -17.37   6.48]<br />
 [ -2.69   0.28   3.04  -2.01   3.9   -3.56   1.05]<br />
 [  3.78  -6.28   9.85   2.82   0.69 -17.63   6.78]<br />
 [ -8.63   1.35   5.59  -4.1    3.66   2.82  -0.7 ]]</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">softmax</span>
<span class="n">proba</span> <span class="o">=</span> <span class="n">softmax</span><span class="p">(</span><span class="n">decision</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="n">proba</span><span class="p">,</span> <span class="n">decimals</span> <span class="o">=</span> <span class="mi">3</span><span class="p">))</span> <span class="c1">#ì†Œìˆ˜ì  ì…‹ì§¸ìë¦¬ê¹Œì§€ í‘œì‹œ
</span></code></pre></div></div>
<blockquote>
  <p>[[0.01  0.73  0.006 0.    0.223 0.    0.03 ]<br />
 [0.01  0.    0.898 0.002 0.    0.    0.089]<br />
 [0.001 0.018 0.28  0.002 0.661 0.    0.038]<br />
 [0.002 0.    0.953 0.001 0.    0.    0.044]<br />
 [0.    0.012 0.816 0.    0.119 0.051 0.002]]</p>
</blockquote>

<p>ì´ë ‡ê²Œ ë¡œì§€ìŠ¤í‹± íšŒê·€ë¥¼ ì‚¬ìš©í•˜ì—¬ 7ê°œì˜ í´ë˜ìŠ¤ì— ëŒ€í•œ í™•ë¥ ì„ ì˜ˆì¸¡í•˜ëŠ” ëª¨ë¸ì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.<br />
ë‹¤ìŒì—ëŠ” í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•ì— ëŒ€í•´ ë°°ì›Œë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

:ET